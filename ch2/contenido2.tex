\section{Análisis de la eficiencia de un algoritmo}

Para esta sección es bueno recordar la definición formal de la notación asintótica:

\definicion{}{}{
    Sea $f : \mathbb{N} \rightarrow \mathbb{R}^+$ se define la notación asintótica como los siguientes conjuntos de funciones:

    \begin{itemize}
        \item $\mathcal{O}(f) = \{ g : \mathbb{N} \rightarrow \mathbb{R}^+ \mid 
        (\exists c \in \mathbb{R}^+)(\exists n_0 \in \mathbb{N})(\forall n \geq n_0)(g(n) \leq c \cdot f(n)) \}$

        \item ${\Omega}(f) = \{ g : \mathbb{N} \rightarrow \mathbb{R}^+ \mid 
        (\exists c \in \mathbb{R}^+)(\exists n_0 \in \mathbb{N})(\forall n \geq n_0)(g(n) \geq c \cdot f(n)) \}$

        \item ${\Theta}(f) = \mathcal{O}(f) \cap {\Omega}(f)$
    \end{itemize}
}

No será de mucha utilidad en nuestro caso, pero se puede saber el rango del valor de los siguientes límites:

\teorema{}{}{
    Sea $f : \mathbb{N} \rightarrow \mathbb{R}^+$ y $g : \mathbb{N} \rightarrow \mathbb{R}^+$, luego

    \begin{itemize}
        \item Si $f(n) \in \mathcal{O}(g(n))$ entonces $\lim_{n \to \infty} \frac{f(n)}{g(n)} \in [0, \infty)$
        \item Si $f(n) \in {\Omega}(g(n))$ entonces $\lim_{n \to \infty} \frac{f(n)}{g(n)} \in (0, \infty]$
        \item Si $f(n) \in {\Theta}(g(n))$ entonces $\lim_{n \to \infty} \frac{f(n)}{g(n)} \in (0, \infty)$

    \end{itemize}
}

\subsection{Ecuaciones de recurrencia}

Una \textbf{recurrencia} es una ecuación o desigualdad que describe
una función en términos de su valor sobre inputs más pequeños.

\ejemplo{}{}{
El peor caso de \textsc{Merge-Sort} está dado por la ecuación de recurrencia

\[
    T(n) = \begin{cases}
            \Theta(1) & \text { si } n = 1\\
            T(\lceil n/2 \rceil) + T(\lfloor n/2 \rfloor) + \Theta(n) & \text{ si } n > 1
            \end{cases}
\]

}

\subsubsection{Sustitución de variables}
Existen varios métodos para resolver estas recurrencias, uno de ellos es la \textbf{sustitución de variables}
que consiste en dos pasos:

\begin{enumerate}
    \item  Adivinar la forma de la solución
    \item Usar inducción para encontrar las constantes y mostrar que la solución funciona
\end{enumerate}

\ejemplo{}{}{
Considere la recurrencia:
\[
    T(n) = 2T(\lfloor n/2 \rfloor) + n
\]

Adivinamos primero que la solución es $T(n) \in \mathcal{O}(n \log n)$, el método de sustitución
requiere demostrar que $T(n) \leq cn \log n$ para algún $c > 0$. Empezamos asumiendo que se cumple 
para todo $m < n$ con $m$ positivo, en particular para $m = \lfloor n/2 \rfloor$, luego tenemos 
que $T(\lfloor n/2 \rfloor) \leq c \lfloor n/2 \rfloor \log(\lfloor n/2\rfloor)$. Sustituyendo en la 
ecuación tenemos que 
\begin{align*}
    T(n)
    &\le 2\bigl(c\lfloor n/2 \rfloor \lg(\lfloor n/2 \rfloor)\bigr) + n \\ 
    &\le cn \lg(n/2) + n \tag{\text{Notar que} $c$ \text{sigue siendo una constante}} \\
    &= cn \lg n - cn \lg 2 + n \\
    &= cn \lg n - cn + n \\
    &\le cn \lg n .
\end{align*}
Solo se necesita que $c \geq 1$.

\vspace*{10pt}

La inducción matemática ahora requiere que mostremos nuestra solución para las condiciones límite. 
Note que para $n = 1$, entonces:

\begin{align*}
    T(1) 
    &\leq c1\log 1 \\
    &= 0
\end{align*}
Lo que es falso ya que $T(1) = 1$. Aquí gracias a la definición formal podemos fijar un $n_0$ que funcione
en este caso podemos elegir $n_0 = 2$. Al escoger este $n_0$, debemos demostrar como casos 
base todos aquellos casos donde la recursión de $T(n)$ resulte en un caso menor a $n_0 = 2$ aquí serían $T(2)$ y $T(3)$ ya que ambos 
dependen de $T(1)$ directamente (dado la ecuación). Queda como ejercicio para el lector definir un $c$ y demostrar por inducción
la cota.
}

\ejercicio{}{a}{
Considere nuevamente la recurrencia de \textsc{Merge-Sort}:
\[ 
    T(n) = \begin{cases}
            \Theta(1) & \text { si } n = 1\\
            T(\lceil n/2 \rceil) + T(\lfloor n/2 \rfloor) + \Theta(n) & \text{ si } n \geq 2
            \end{cases}
\]

Encuentre el orden $f : \mathbb{N} \rightarrow \mathbb{R}^+$ de $\mathcal{O}$ de $T(n)$ y demuestre formalmente que $T(n) \in \mathcal{O}(f(n))$.

\vspace*{10pt}
\color{blue!100!black} 

\textbf{Solución:} Escogemos $f(n) = n \log n$, en este caso particular nos conviene el reemplazo 
$T(n) \leq cn \log (n-1)$ debido a las funciones techo en la ecuación, luego 
\begin{align*}
    T(n) 
    &\leq c \lceil n/2 - 1 \rceil \log  \lceil n/2 - 1 \rceil + c \lfloor n/2 - 1 \rfloor \log  \lfloor n/2 - 1 \rfloor + n\\
    &\leq c \lceil n/2 - 1 \rceil (2\log \lceil n/2 - 1 \rceil) \\
    &\leq cn \Biggl(\log \frac{(n+1)}{2} - 1\Biggr) \\
    &\leq cn \log (n - 1)
\end{align*}


Ahora falta encontrar $c$, $n_0$ y demostrar por inducción que se cumple para todo $n \geq n_0$. En este caso elegiremos 
$c = 3$ y $n_0 = 3$, ya que para $T(1)$ y $T(2)$ no se cumple. Luego nuestros casos bases son $\{3,4,5\}$ para los cuales
se cumple (lo puede comprobar), luego para el paso inductivo con $n \geq 6$ tenemos que:
\begin{align*}
    T(n) 
    &\leq 3 \lceil n/2 - 1 \rceil \log  \lceil n/2 - 1 \rceil + \lfloor n/2 - 1 \rfloor \log  \lfloor n/2 - 1 \rfloor + n\\
    &\leq 3n (\log \lceil n/2 - 1 \rceil) \\
    &\leq 3n \Biggl(\log \frac{(n+1)}{2} - 1\Biggr) \\
    &\leq 3n \log (n - 1) \hspace*{10pt}\triangle
\end{align*}


}

Hay casos donde puede resultar problemático encontrar la función solo con definición 2.1:
\ejemplo{}{}{
Considere la recurrencia:
\[
    T(n) = \begin{cases}
            0 & \text { si } n = 0\\
            n^2 + n \cdot T(n - 1)& \text{ si } n > 0
            \end{cases}
\]

Intentemos inmediatamente usar $f(n) = n!$ y resolver por inducción, suponemos que $T(n) \leq c \cdot n!$ luego tenemos que
\begin{align*}
    T(n + 1) 
    &= (n+1)^2 + (n + 1) \cdot T(n)\\
    &\leq (n+1)^2 + (n + 1) \cdot (c \cdot n!)\\
    &= (n+1)^2 + c \cdot (n + 1)!
\end{align*}

{\color{strongorange}  Note que es imposible que $c \cdot (n + 1)! \geq (n+1)^2 + c \cdot (n + 1)!$, $\forall c \in \mathbb{R}^+$.}

\vspace*{10pt}

Aquí para poder progresar, podemos usar una definición más fuerte

\[\color{strongorange} 
    (\exists c \in \mathbb{R}^+)(\exists d \in \mathbb{R}^+)(\exists n_0 \in \mathbb{N})(\forall n \geq n_0)(T(n) \leq c \cdot n! - dn)
\]

Esto debido a que $c \cdot n! - dn \leq c \cdot n!$, ahora completando la inducción, tendríamos que 

\begin{align*}
    T(n + 1) 
    &= (n+1)^2 + (n + 1) \cdot T(n)\\
    &\leq (n+1)^2 + (n + 1) \cdot (c \cdot n! - dn)\\
    &=  c \cdot (n + 1)! + (n+1)^2 - (n + 1)dn \\
    &=  c \cdot (n + 1)! + (n + 1)((n+1) - dn)
\end{align*}

Ahora necesitamos restringir $d$ \begin{align*}
c \cdot (n + 1)! + (n + 1)((n+1) - dn)
&\le c(n+1)! - d(n+1) \\
(n + 1) - dn
&\le -d \\
n + 1
&\le d(n - 1) \\
\frac{n + 1}{n - 1}
&\le d
\end{align*}

Considerando $n \geq 2$, entonces $d \geq 3$. Como ejercicio para el lector encuentre el valor de $n_0$ y $c$ para 
después mostrar el caso base y concluir.

}

\subsubsection{Algunas sutilezas de la sustitución de variables}
Es fácil equivocarse al usar notación asintótica, considere por ejemplo la recurrencia del ejemplo 2.2
\[
    T(n) = 2T(\lfloor n/2 \rfloor) + n
\]
Podemos ``demostrar'' falsamente que $T(n) \in \mathcal{O}(n)$ suponiendo que $T(n) \leq cn$ y luego argumentando

\begin{align*}
    T(n) 
    &\leq 2(c\lceil n/2 \rceil) + n\\
    &\leq cn + n\\
    &\in \mathcal{O}(n)
\end{align*}

La conclusión de que $T(n) \in \mathcal{O}(n)$ es falsa, para demostrarlo de manera real se debe llegar 
a la forma exacta de hipótesis de inducción, es decir $T(n) \leq cn$.

\vspace*{10pt}
\ejemplo{Cambio de variable}{}{
Otro problema que puede surgir al usar este método es que nos den una recurrencia extraña y difícil de manipular,
por ejemplo la recurrencia
\[
    T(n) = 2T(\lfloor \sqrt{n} \rfloor) + \log n
\]
Aquí podemos simplificar la recurrencia utilzando un \textbf{cambio de variables} similar a como se 
hace en cálculo, aquí escogemos {\color{strongorange}$m = \log n$} y tenemos que 
\[
    T(2^m) = 2T(2^{(m/2)}) + m
\]Ahora podemos asignar  {\color{strongorange}$S(m) = T(2^m)$} y tenemos que 
\[
    S(m) = 2S(m/2) + m
\]\noindent Resolviendo esta recurrencia familiar tenemos que $S(m) \in \mathcal{O}(m \log m)$, luego reemplazando devuelta 
$$m \log m = \log n \log (\log n)$$ 
Por lo tanto $T(n) \in \mathcal{O}(\log n \log (\log n))$ (que es una familia de funciones bastante extraña).
}


\subsection{El Teorema Maestro}
